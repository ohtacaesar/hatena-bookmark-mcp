# はてなブックマークフィードMCP - 要件書

## 概要
はてなブックマークのRSSフィードAPIにアクセスし、ユーザーのブックマーク情報を取得・操作できるMCP（Model Context Protocol）サーバーを実装する。

## 機能要件

### F1. ユーザーブックマークフィード取得
- **説明**: 指定されたユーザーのブックマークRSSフィードを取得する
- **エンドポイント**: `https://b.hatena.ne.jp/[username]/rss`
- **パラメータ**:
  - `username` (必須): はてなブックマークのユーザー名
  - `page` (オプション): ページ番号（デフォルト: 1、1ページあたり20件）

### F2. タグフィルタリング機能
- **説明**: 特定のタグが付いたブックマークのみを取得する
- **パラメータ**:
  - `tag` (オプション): フィルタリングするタグ名

### F3. 日付フィルタリング機能
- **説明**: 特定の日付のブックマークのみを取得する
- **パラメータ**:
  - `date` (オプション): YYYYMMDD形式の日付

### F4. URLフィルタリング機能
- **説明**: 特定のURLに関連するブックマークのみを取得する
- **パラメータ**:
  - `url` (オプション): フィルタリング対象のURL

### F5. ブックマーク情報の構造化
- **説明**: 取得したRSSフィードを解析し、構造化されたデータとして提供する
- **含まれる情報**:
  - タイトル
  - URL
  - ブックマーク日時
  - タグ（`dc:subject`から抽出）
  - コメント（存在する場合）

## 非機能要件

### NF1. レスポンス時間
- はてなブックマークAPIへのリクエストは10秒以内にレスポンスを返すこと

### NF2. エラーハンドリング
- ネットワークエラー、APIエラー、不正なパラメータに対して適切なエラーメッセージを返すこと
- 存在しないユーザー名が指定された場合の処理を定義すること

### NF3. データ形式
- 出力データはJSON形式で構造化されていること
- 日本語文字列が適切に処理されること

### NF4. MCP準拠
- Model Context Protocol (MCP) の仕様に準拠していること
- 標準的なMCPツールとして認識・実行可能であること

## 制約事項

### C1. API制限
- はてなブックマークの利用規約に準拠すること
- 過度なリクエストを避け、適切な間隔でAPIを呼び出すこと

### C2. 認証
- はてなブックマークの公開RSSフィードのみアクセス可能
- プライベートブックマークにはアクセスできない

### C3. データ取得制限
- 1回のリクエストで取得できるのは最大20件のブックマーク
- 更に多くのデータが必要な場合はページネーションを使用すること

## 使用例

```
# 基本的な使用例
get_hatena_bookmarks(username="sample")

# タグフィルタリング
get_hatena_bookmarks(username="sample", tag="book")

# 日付フィルタリング  
get_hatena_bookmarks(username="sample", date="20240320")

# URLフィルタリング
get_hatena_bookmarks(username="sample", url="https://example.com")

# ページネーション
get_hatena_bookmarks(username="sample", page=2)
```

## 期待される出力形式

```json
{
  "user": "sample",
  "page": 1,
  "total_count": 20,
  "bookmarks": [
    {
      "title": "記事タイトル",
      "url": "https://example.com/article",
      "bookmarked_at": "2024-03-20T10:30:00Z",
      "tags": ["技術", "プログラミング"],
      "comment": "ユーザーのコメント"
    }
  ]
}
```